<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secure Access Portal</title>
    <style>
        /* --- 1. SETTINGS & RESET --- */
        :root {
            --primary: #2563eb; /* Main Blue Color */
            --bg: #f8fafc;      /* Light Gray Background */
            --text: #1e293b;    /* Dark Text */
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background: var(--bg);
            margin: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            /* Security: Disable Text Selection */
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        /* --- 2. LOGIN SCREEN STYLES --- */
        #login-screen {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }

        .card {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            text-align: center;
            width: 90%;
            max-width: 340px;
        }

        /* LOGO IMAGE STYLES */
        .logo-wrapper {
            width: 90px;
            height: 90px;
            background-color: white; 
            border-radius: 50%; /* Makes it circular */
            margin: 0 auto 25px auto; /* Centers it */
            display: flex;
            justify-content: center;
            align-items: center;
            border: 3px solid #f1f5f9; /* Subtle border around logo */
            overflow: hidden; /* Clips the image to the circle */
        }

        .logo-wrapper img {
            width: 100%;
            height: 100%;
            object-fit: cover; /* Ensures logo covers the circle without squishing */
        }

        h2 { margin: 0 0 10px 0; color: var(--text); font-size: 1.25rem; }
        p.subtitle { margin: 0 0 20px 0; color: #64748b; font-size: 14px; }

        /* General Input Style */
        .auth-input {
            width: 100%;
            padding: 12px 15px;
            margin-bottom: 12px;
            font-size: 16px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            box-sizing: border-box;
            outline: none;
            transition: border-color 0.2s;
            color: #334155;
        }
        .auth-input:focus { border-color: var(--primary); }

        /* PIN Specific Style */
        .pin-input {
            text-align: center;
            letter-spacing: 8px;
            font-weight: bold;
            font-size: 18px;
            /* Security: Hides numbers visually like password dots */
            -webkit-text-security: disc; 
            -moz-text-security: disc;
        }
        
        .btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 15px;
            width: 100%;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s;
            margin-top: 10px;
        }
        .btn:hover { background-color: #1d4ed8; }

        /* --- 3. DASHBOARD STYLES --- */
        #dashboard-screen {
            display: none; /* Hidden initially */
            height: 100%;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .link-container {
            width: 100%;
            max-width: 500px;
            background: white;
            border-radius: 16px;
            padding: 25px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            max-height: 90vh; /* Prevent overflow on small screens */
            overflow-y: auto;
        }

        .resource-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: #f8fafc;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 10px;
            cursor: pointer;
            border: 1px solid #e2e8f0;
            transition: all 0.2s;
            font-weight: 500;
        }

        .resource-item:hover {
            background: #eff6ff;
            border-color: var(--primary);
            color: var(--primary);
            transform: translateX(5px);
        }

        /* --- 4. INTERNAL VIEWER STYLES --- */
        #viewer-screen {
            display: none;
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: white;
            flex-direction: column;
            z-index: 3000;
        }

        .viewer-header {
            height: 54px;
            background: #1e293b;
            color: white;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            font-weight: 600;
        }

        .close-btn {
            background: #ef4444;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
        }

        iframe {
            flex-grow: 1;
            border: none;
            width: 100%;
            height: 100%;
            background: #f1f5f9;
        }

        /* Overlay to help block clicks inside iframe if desired */
        .click-guard {
            position: absolute;
            top: 54px; left: 0; width: 100%; height: calc(100% - 54px);
            pointer-events: none; /* Change to 'auto' to block all interaction */
        }

    </style>
</head>
<body oncontextmenu="return false;">

    <div id="login-screen">
        <div class="card">
            
            <div class="logo-wrapper">
                <img src="https://uploads.onecompiler.io/443wbvtn6/447b6rz6y/kementerian-pendidikan-malaysia-jata-negara-logo-png_seeklogo-439161.png" alt="Company Logo">
            </div>
            <h2>Koleksi Soalan Peperiksaan Akhir Semester</h2>
            <p class="subtitle">Institut Latihan Kementerian Kesihatan Malaysia</p>
            
            <!-- NEW FIELDS: NAME & ID -->
            <input type="text" id="full-name" class="auth-input" placeholder="Nama Penuh (Full Name)">
            <input type="text" id="student-id" class="auth-input" placeholder="No. Matrik / ID Number">
            
            <!-- PIN FIELD -->
            <input type="text" id="pin" class="auth-input pin-input" placeholder="PIN" maxlength="8">
            
            <button class="btn" onclick="checkPin()">Masuk (Enter)</button>
            <p id="error" style="color:#ef4444; display:none; margin-top:15px; font-weight:500;">Incorrect PIN or Missing Details.</p>
        </div>
    </div>

    <div id="dashboard-screen">
        <div class="link-container">
            <h2 style="margin-top:0;">Bank Soalan</h2>
            <p class="subtitle">Sila pilih berdasarkan tahun pengajian</p>

            <div class="resource-item" onclick="openViewer('https://docs.google.com/document/d/e/2PACX-1vSohswmpnmEQHkc1id0HzkTrAkTGt9RhREr8ajKhPvY6q2_61odFik8zDKYMY_NzvPTaLeSri9NxJ3I/pub')">
                <span>Tahun 1 Semester 1</span>
                <span>→</span>
            </div>

            <div class="resource-item" onclick="openViewer('https://docs.google.com/document/d/e/2PACX-1vSwL2taZMiXLKyIjZR9oqiMSYoXwWSa3ZRchwHT95OGaI17rYzGJwSf_L7Q0PSAbw/pub')">
                <span>Tahun 1 Semester 2</span>
                <span>→</span>
            </div>

             <div class="resource-item" onclick="openViewer('https://docs.google.com/document/d/e/2PACX-1vR-79pfCP9G5DL1xGdY5v-ZSK0XatKdhUWKkN9ziBwrdX422AtYmnbA4ddy3ss1dw/pub')">
                <span>Tahun 2 Semester 1</span>
                <span>→</span>
            </div>
            <div class="resource-item" onclick="openViewer('https://www.youtube.com/embed/dQw4w9WgXcQ')">
                <span>Tahun 2 Semester 2</span>
                <span>→</span>
            </div>
            <div class="resource-item" onclick="openViewer('https://www.youtube.com/embed/dQw4w9WgXcQ')">
                <span>Tahun 3 Semester 1</span>
                <span>→</span>
            </div>
            <div class="resource-item" onclick="openViewer('https://www.youtube.com/embed/dQw4w9WgXcQ')">
                <span>Tahun 3 Semester 2</span>
                <span>→</span>
            </div>

            <button class="btn" onclick="location.reload()" style="margin-top:25px; background-color: transparent; color: #64748b; border: 1px solid #e2e8f0;">Log Out</button>
        </div>
    </div>

    <div id="viewer-screen">
        <div class="viewer-header">
            <span>Viewing Content...</span>
            <button class="close-btn" onclick="closeViewer()">Close ✕</button>
        </div>
        <iframe id="content-frame" src=""></iframe>
        <div class="click-guard"></div> 
    </div>

    <script>
        // --- CONFIGURATION ---
        const SECRET = "2025"; 
        
        // PASTE YOUR GOOGLE APPS SCRIPT WEB APP URL HERE:
        // Example: const LOGGING_URL = "https://script.google.com/macros/s/AKfycbx.../exec";
        const LOGGING_URL = "https://script.google.com/macros/s/AKfycbyQbbn9ggN8_27UQD2jhnIgyq6AVh4dZblKGegGImFkQPOiXk3POKqiv26HdNYEZbc/exec"; 
        // ---------------------

        // Login Logic
        function checkPin() {
            const pinInput = document.getElementById('pin');
            const nameInput = document.getElementById('full-name');
            const idInput = document.getElementById('student-id');
            const errorMsg = document.getElementById('error');

            // 1. Basic Validation (Must fill all fields)
            if(!nameInput.value || !idInput.value) {
                errorMsg.innerText = "Sila isi Nama dan No. Matrik.";
                errorMsg.style.display = 'block';
                return;
            }

            // 2. PIN Validation
            if(pinInput.value === SECRET) {
                // Hide Login, Show Dashboard
                document.getElementById('login-screen').style.display = 'none';
                document.getElementById('dashboard-screen').style.display = 'flex';

                // 3. Log to Google Sheets
                logAccess(nameInput.value, idInput.value);

            } else {
                errorMsg.innerText = "PIN Salah.";
                errorMsg.style.display = 'block';
                pinInput.value = ''; 
                pinInput.focus();
            }
        }

        function logAccess(name, id) {
            if (!LOGGING_URL) return; // Do nothing if no URL set

            const data = { name: name, id: id };
            
            // Use 'no-cors' mode to bypass CORS restriction. 
            // We won't get a response, but the data will be sent.
            fetch(LOGGING_URL, {
                method: 'POST',
                mode: 'no-cors', 
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            }).catch(err => console.error("Logging failed", err));
        }

        // Open Internal Viewer
        function openViewer(url) {
            const viewer = document.getElementById('viewer-screen');
            const frame = document.getElementById('content-frame');
            frame.src = url;
            viewer.style.display = 'flex';
        }

        // Close Internal Viewer
        function closeViewer() {
            const viewer = document.getElementById('viewer-screen');
            const frame = document.getElementById('content-frame');
            frame.src = ""; // Stop content loading
            viewer.style.display = 'none';
        }

        // Enter Key Support
        document.getElementById("pin").addEventListener("keypress", function(e) {
            if (e.key === "Enter") checkPin();
        });

        // Security: Disable common keyboard shortcuts
        document.onkeydown = function(e) {
            if (e.keyCode == 123) return false; // F12
            if (e.ctrlKey && e.shiftKey && (e.keyCode == 73 || e.keyCode == 67)) return false; // Inspect/Copy
            if (e.ctrlKey && (e.keyCode == 85 || e.keyCode == 83)) return false; // View Source/Save
        };
    </script>
</body>
</html>